/*
 * Scrollface - A basic jQuery slideshow
 
 * Copyright (c) 2011 Kyle Truscott
 *
 * http://keighl.github.com/scrollface
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
(function(a){"use strict";var b={init:function(d){return a(this).each(function(){var e=a(this),f=a(this).data("scrollface"),g={pager:null,pager_builder:b.pager_builder,next:null,prev:null,active_pager_class:"active",speed:300,easing:"linear",auto:!0,interval:2e3,before:b.before,after:b.after,transition:"horizontal"};if(!f){d&&a.extend(g,d),g.slides=a(this).children(),g.count=g.slides.size(),g.height=a(this).height(),g.width=a(this).width(),g.index=0,g.is_moving=!1,g.timer=null;switch(g.transition){case"vertical":g.transition=c.vertical;break;case"random":g.transition=c.random;break;default:g.transition=c.horizontal}a(this).css({position:"absolute"}),a(g.slides).each(function(c,d){a(d).css({position:"absolute",left:c===0?0:g.width*100,top:0,display:c===0?"block":"none"});var f=null;a(g.pager).size()&&typeof g.pager_builder=="function"&&(f=g.pager_builder.call(e,g.pager,c,d),c===0&&a(f).addClass(g.active_pager_class),a(f).bind("click.scrollface",function(){return b.interrupt.call(e),b.step_to.call(e,c),!1}))}),a(g.next).size()&&a(g.next).bind("click.scrollface",function(a){b.interrupt.call(e),b.next.call(e)}),a(g.prev).size()&&a(g.prev).bind("click.scrollface",function(a){b.interrupt.call(e),b.prev.call(e)}),a(this).data("scrollface",g),g.auto&&b.start.call(e)}})},destroy:function(){return a(this).each(function(){var b=a(this).data("scrollface");if(b)a(b.next).size()&&a(b.next).unbind("click.scrollface"),a(b.prev).size()&&a(b.prev).unbind("click.scrollface"),a(this).data("scrollface",null);else return!1})},step_to:function(b,d,e){return a(this).each(function(){var f=a(this).data("scrollface");if(!f)return!1;if(!f.is_moving&&b!==f.index&&b<=f.count-1&&b>=0){f.is_moving=!0,a(f.pager).size()&&(a("a",f.pager).removeClass(f.active_pager_class),a("a",f.pager).eq(b).addClass(f.active_pager_class));if(typeof f.before=="function"){var g={id:f.index,slide:a(f.slides[f.index])},h={id:b,slide:a(f.slides[b])};f.before.call(this,g,h)}e&&c[e]?c[e].call(this,b,d):f.transition.call(this,b,d)}})},next:function(c,d){return a(this).each(function(){var e=a(this).data("scrollface");if(!e)return!1;var f=e.index===e.count-1?0:e.index+1;c=c||"advance",b.step_to.call(this,f,c,d)})},prev:function(c,d){return a(this).each(function(){var e=a(this).data("scrollface");if(!e)return!1;var f=e.index===0?e.count-1:e.index-1;c=c||"retreat",b.step_to.call(this,f,c,d)})},start:function(){return a(this).each(function(){var c=a(this).data("scrollface");if(!c)return!1;var d=this;c.timer||(c.timer=setInterval(function(){b.next.call(d)},c.interval))})},stop:function(){return a(this).each(function(){var b=a(this).data("scrollface");if(!b)return!1;b.timer&&(clearInterval(b.timer),b.timer=null)})},interrupt:function(c){return a(this).each(function(){var d=a(this).data("scrollface");if(!d)return!1;var e=a(this),f=0;d.timer&&(typeof c!="number"?f=d.interval:f=c,b.stop.call(this),setTimeout(function(){b.start.call(e)},f))})},pager_builder:function(b,c,d){var e=a(document.createElement("a")).html(c+1).appendTo(a(b));return e},before:function(a,b){return!0},after:function(a,b){return console.log(a),console.log(b),!0}},c={horizontal:function(b,c){var d=a(this).data("scrollface");if(!d)return!1;var e=parseInt(a(this).css("left"),10)||0,f=a(d.slides[d.index]),g=parseInt(a(f).css("left"),10)||0,h=parseInt(a(f).css("top"),10)||0,i=c==="advance"?g+d.width:g-d.width,j=a(d.slides[b]).css({left:i,top:h}).show(),k=c==="advance"?e-d.width:e+d.width;a(this).stop().animate({left:k},d.speed,d.easing,function(){if(typeof d.after=="function"){var c={id:d.index,slide:a(d.slides[d.index])},e={id:b,slide:a(d.slides[b])};d.after.call(this,c,e)}a(f).hide(),d.index=b,d.is_moving=!1})},vertical:function(b,c){var d=a(this).data("scrollface");if(!d)return!1;var e=parseInt(a(this).css("top"),10)||0,f=a(d.slides[d.index]),g=parseInt(a(f).css("top"),10)||0,h=parseInt(a(f).css("left"),10)||0,i=c==="advance"?g+d.height:g-d.height,j=a(d.slides[b]).css({top:i,left:h}).show(),k=c==="advance"?e-d.height:e+d.height;a(this).stop().animate({top:k},d.speed,d.easing,function(){if(typeof d.after=="function"){var c={id:d.index,slide:a(d.slides[d.index])},e={id:b,slide:a(d.slides[b])};d.after.call(this,c,e)}a(f).hide(),d.index=b,d.is_moving=!1})},random:function(b,d){var e=a(this).data("scrollface");if(!e)return!1;var f=["horizontal","vertical"],g=f[Math.floor(Math.random()*f.length)];c[g].call(this,b,d)}};a.fn.scrollface=function(c){if(b[c])return b[c].apply(this,Array.prototype.slice.call(arguments,1));if(typeof c=="object"||!c)return b.init.apply(this,arguments);a.error("Method "+c+" does not exist on jQuery.scrollface!")}})(jQuery)