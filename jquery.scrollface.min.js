/*
 * Scrollface - A basic jQuery slideshow

 * Copyright (c) 2012 Kyle Truscott
 *
 * http://keighl.github.com/scrollface
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
(function(e){"use strict";var t={init:function(n){return e(this).each(function(){var r=e(this),i=e(this).data("scrollface"),s={pager:null,pager_builder:t.pager_builder,next:null,prev:null,active_pager_class:"active",speed:300,easing:"linear",auto:!0,interval:2e3,before:t.before,after:t.after,transition:"horizontal"};if(!i){n&&e.extend(s,n),s.slides=e(this).children(),s.count=s.slides.size(),s.height=e(this).height(),s.width=e(this).width(),s.index=0,s.is_moving=!1,s.timer=null;if(s.slides.length<=1)return!1;e(this).css({position:"absolute"}),e(s.slides).each(function(n,i){e(i).css({position:"absolute",left:n===0?0:s.width*100,top:0,display:n===0?"block":"none"});var o=null;e(s.pager).size()&&typeof s.pager_builder=="function"&&(o=s.pager_builder.call(r,s.pager,n,i),n===0&&e(o).addClass(s.active_pager_class),e(o).bind("click.scrollface",function(){return t.interrupt.call(r),t.step_to.call(r,n),!1}))}),e(s.next).size()&&e(s.next).bind("click.scrollface",function(e){t.interrupt.call(r),t.next.call(r)}),e(s.prev).size()&&e(s.prev).bind("click.scrollface",function(e){t.interrupt.call(r),t.prev.call(r)}),e(this).data("scrollface",s),s.auto&&t.start.call(r)}})},destroy:function(){return e(this).each(function(){var t=e(this).data("scrollface");if(!t)return!1;e(t.next).size()&&e(t.next).unbind("click.scrollface"),e(t.prev).size()&&e(t.prev).unbind("click.scrollface"),e(this).data("scrollface",null)})},step_to:function(t,r){return e(this).each(function(){var i=e(this).data("scrollface");if(!i)return!1;if(!i.is_moving&&t!==i.index&&t<=i.count-1&&t>=0){i.is_moving=!0;var s={speed:i.speed,easing:i.easing,direction:null,transition:i.transition};r&&e.extend(s,r),s.direction||(t>i.index&&(s.direction="advance"),t<i.index&&(s.direction="retreat")),e(i.pager).size()&&(e("a",i.pager).removeClass(i.active_pager_class),e("a",i.pager).eq(t).addClass(i.active_pager_class));if(typeof i.before=="function"){var o={id:i.index,idx:i.index,slide:e(i.slides[i.index])},u={id:t,idx:t,slide:e(i.slides[t])};i.before.call(this,o,u)}n[s.transition].call(this,t,s)}})},next:function(n){return e(this).each(function(){var r=e(this).data("scrollface");if(!r)return!1;var i=r.index===r.count-1?0:r.index+1,s={direction:"advance"};n&&e.extend(s,n),t.interrupt.call(this),t.step_to.call(this,i,s)})},prev:function(n){return e(this).each(function(){var r=e(this).data("scrollface");if(!r)return!1;var i=r.index===0?r.count-1:r.index-1,s={direction:"retreat"};n&&e.extend(s,n),t.interrupt.call(this),t.step_to.call(this,i,s)})},start:function(){return e(this).each(function(){var n=e(this).data("scrollface");if(!n)return!1;var r=this;n.timer||(n.timer=setInterval(function(){t.next.call(r)},n.interval))})},stop:function(){return e(this).each(function(){var t=e(this).data("scrollface");if(!t)return!1;t.timer&&(clearInterval(t.timer),t.timer=null)})},interrupt:function(n){return e(this).each(function(){var r=e(this).data("scrollface");if(!r)return!1;var i=e(this),s=0;r.timer&&(typeof n!="number"?s=r.interval:s=n,t.stop.call(this),setTimeout(function(){t.start.call(i)},s))})},pager_builder:function(t,n,r){var i=e(document.createElement("a")).html(n+1).appendTo(e(t));return i},before:function(e,t){return!0},after:function(e,t){return!0}},n={horizontal:function(t,n){var r=e(this).data("scrollface");if(!r)return!1;var i=parseInt(e(this).css("left"),10)||0,s=e(r.slides[r.index]),o=parseInt(e(s).css("left"),10)||0,u=parseInt(e(s).css("top"),10)||0,a=n.direction==="advance"?o+r.width:o-r.width,f=e(r.slides[t]).css({left:a,top:u}).show(),l=n.direction==="advance"?i-r.width:i+r.width;e(this).stop().animate({left:l},n.speed,n.easing,function(){if(typeof r.after=="function"){var n={id:r.index,idx:r.index,slide:e(r.slides[r.index])},i={id:t,idx:t,slide:e(r.slides[t])};r.after.call(this,n,i)}e(s).hide(),r.index=t,r.is_moving=!1})},vertical:function(t,n){var r=e(this).data("scrollface");if(!r)return!1;var i=parseInt(e(this).css("top"),10)||0,s=e(r.slides[r.index]),o=parseInt(e(s).css("top"),10)||0,u=parseInt(e(s).css("left"),10)||0,a=n.direction==="advance"?o+r.height:o-r.height,f=e(r.slides[t]).css({top:a,left:u}).show(),l=n.direction==="advance"?i-r.height:i+r.height;e(this).stop().animate({top:l},n.speed,n.easing,function(){if(typeof r.after=="function"){var n={id:r.index,idx:r.index,slide:e(r.slides[r.index])},i={id:t,idx:t,slide:e(r.slides[t])};r.after.call(this,n,i)}e(s).hide(),r.index=t,r.is_moving=!1})},fade:function(t,n){var r=e(this).data("scrollface");if(!r)return!1;var i=e(r.slides[r.index]).css({zIndex:0}),s=parseInt(e(i).css("top"),10)||0,o=parseInt(e(i).css("left"),10)||0,u=e(r.slides[t]).css({left:o,top:s,zIndex:1});e(u).fadeTo(r.speed,1,function(){e(i).css({left:r.width,zIndex:0}).hide();if(typeof r.after=="function"){var n={id:r.index,idx:r.index,slide:e(r.slides[r.index])},s={id:t,idx:t,slide:e(r.slides[t])};r.after.call(this,n,s)}e(i).hide(),r.index=t,r.is_moving=!1})},random:function(t,r){var i=e(this).data("scrollface");if(!i)return!1;var s=["horizontal","vertical","fade"],o=s[Math.floor(Math.random()*s.length)];n[o].call(this,t,r)}};e.fn.scrollface=function(n){if(t[n])return t[n].apply(this,Array.prototype.slice.call(arguments,1));if(typeof n=="object"||!n)return t.init.apply(this,arguments);e.error("Method "+n+" does not exist on jQuery.scrollface!")}})(jQuery);